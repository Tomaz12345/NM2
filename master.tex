\documentclass[a4paper,12pt]{article}

% General document formatting
%\usepackage[margin=0.7in]{geometry}
\usepackage[parfill]{parskip}
\usepackage{url, hyperref}
\usepackage{color}
\usepackage[usestackEOL]{stackengine}[2013-10-15] % formatting Pascal
\usepackage[dvipsnames]{xcolor}

\usepackage{cancel}
\usepackage[export]{adjustbox}

% Related to math
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{mathtools}
\usepackage{tikz}
\DeclarePairedDelimiter\norm{\lVert}{\rVert}
\newcommand{\innerproduct}[2]{\langle #1, #2 \rangle}

% encoding and language
\usepackage{lmodern}
\usepackage[slovene]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[mathscr]{euscript}

% multiline comments
\usepackage{verbatim}

% images
\usepackage{graphicx}
\graphicspath{ {./images/} }

% theorems
\theoremstyle{definition}
\newtheorem{counter}{Counter}[section] % not for use
\newtheorem{defn}[counter]{Definicija}
\newtheorem{lemma}[counter]{Lema}
\newtheorem{conseq}[counter]{Posledica}
\newtheorem{claim}[counter]{Trditev}
\newtheorem{theorem}[counter]{Izrek}
%%
\theoremstyle{remark}
\newtheorem*{ex}{Primer}
\newtheorem*{rem}{Opomba}
\newtheorem{rem*}[counter]{Opomba}
\newtheorem{ex*}[counter]{Primer}

% I like my squares DARK
\renewcommand\qedsymbol{$\blacksquare$}

% common commands redefined convenience purposes
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\ch}{\operatorname{char}}


\begin{document}

\title{Numeri"cne metode 2\\ \small zapiski s predavanj prof. Marjetke Knez}
\author{Domen Vogrin}
\date{pomlad 2023}
\maketitle


\pagenumbering{roman}
\tableofcontents
\newpage
\pagenumbering{arabic}


% 13. 2. 2023
\section{Teorija aproksimacije}

\subsection{Aproksimacija funkcij}
Denimo, da imamo podano funkcijo $f$. Radi bi jo aproksimirali s kak"sno 'preprostej"so' funkcijo $\tilde{f}$, ki bi bila la"zje izra"cunljiva, bi se jo dalo enostavno odvajati, integrirati ...

\begin{ex}
    \[sin(x) \sim x - \frac{x^3}{3!} + \frac{x^5}{5!}\]
\end{ex}


Klju"cna vpra"sanja, ki se nam postavijo, so:
\begin{itemize}
    \item V kak"sni mno"zici/podprostoru naj i"s"cemo aproksimant $\tilde{f}$?
    \item V "cem naj si bo $\tilde{f}$ podobna/sorodna z $f$?
    \item Ali $\tilde{f}$ obstaja (v mno"zici, kjer jo i"s"cemo)?
    \item "ce obstaja, ali je dolo"cen enoli"cno?
    \item Kako konstruirati aproksimant $\tilde{f}$?
    \item Kako dobro nadomestilo za $f$ je izra"cunan $\tilde{f}$?
\end{itemize}

V splo"snem aproksimacijski problem formaliramo takole:

z $X$ ozna"cimo vektorski prostor, katerega elemente "zelimo aproksimirati, $S \subseteq X$ naj ozna"cuje podprostor/podmno"zico v $X$, v katerem i"s"cemo aproksimante. Aproksimacijska shema je operator 
\[\mathscr{A}\colon X \to S\]
ki vsakemu elementu $f \in X$ priredi aproksimacijski element (aproksimant) \[\tilde{f} = \mathscr{A} f \in S'\]

\begin{ex}
    Vektorski prostori:
    \begin{itemize}
        \item $X = \mathscr{C}([a, b]), X = \mathscr{C}^k([a, b])$
        \item $X = \mathscr{L}^{2}_{\rho}([a, b]) = \{f\colon[a, b] \to \R$ $\int_{a}^{b} \rho (x) dx < \infty \}$,\\
        pri "cemer je $\rho \textbf{ pozitivna ute"z: } \rho (x) > 0$ za vsak $x \in [a, b]$
        \item $X = \R ^n$
    \end{itemize}
\end{ex}

\begin{ex}
    Podprostori, v katerih i"s"cemo aproksimante:
    
    \begin{itemize}
        \item $S = P_n = Lin\{1, x, x^2, \dots, x^n\}$ polinom stopnje $\leq$ $n$ = \\
        $\{ \sum_{i = 0}^{n} a_i x^i; a_i \in \R \}$
        \item $S = Lin\{1, \sin x, \cos x, \sin 2x, \cos 2x, \dots, \sin nx, \cos nx\} \\
        \textbf{triginimetri"cni polinomi}$
        \item podprostori racionalnih funkcij, odsekoma polinomskih funkcij
    \end{itemize}
\end{ex}

Da bomo lahko definirali aproksimacijski problem in tudi ocenili napako aproksimacije, potrebujemo \textbf{normo}. Najbolj znane norme na prostoru funkcij so naslednje:

\begin{itemize}
    \item neskon"cna norma ($\norm{f}_{\infty}$)
    \[f \in \mathscr{C}([a, b]), \norm{f}_{\infty, [a, b]} = \max_{x \in [a, b]} |f(x)|\]
    Za izra"cun numeri"cnega pribli"zka za neskon"cno normo na intervalu $[a, b]$ izberemo dovolj gosto zaporedje to"ck:
    \[a \leq x_0 < x_1 < ... < x_n \leq b, \textbf{x} = (x_i)_{i=0}^N\]
    in izra"cunamo
    \[\norm{f}_{\infty, \textbf{x}} = \max_{i = 1, \dots, N} |f(x_i)|\]
    \item druga norma - norma, porojena iz skalarnega produkta
    Naj bo vektorski prostor $X$ opremljen s skalarnim produktom $\innerproduct{\cdot}{\cdot}$. Potem je $||f||_2 = \sqrt{\innerproduct{f}{f}}$.
    Primeri skalarnih produktov:
    \begin{enumerate}
        \item[$\cdot$] $\innerproduct{f}{g} = \int_{a}^{b} f(x) g(x) \rho(x) dx$, $f, g \in \mathscr{L}_{\rho}^2 ([a, b])$
        \item[$\cdot$] $\norm{f}_2 = \sqrt[]{\int_{a}^{b} f^2(x)\rho(x)dx }$
        
        Za $f(x) \equiv 1$ to imenujemo $\textbf{standardni skalarni produkt}$
    \end{enumerate}
    \item diskretni semi-skalarni produkt
    \[\textbf{x} = (x_i)_{i=0}^N, a \leq x_0 < x_1 < ... < x_n \leq b\]
    \[\innerproduct{f}{g} = \sum_{i = 0}^{N} f(x_i) g(x_i) \rho(x_i)\]
    "Ce ga "se delimo z dol"z"ino intervala, dobimo pribli"zek za prej"snjega.
    \[\norm{f}_{2, \textbf{x}} = \sqrt[]{\sum_{i = 0}^{N} f^2(x_i)\rho(x_i)}\]
\end{itemize}


Za dolo"canje aproksimanta $\tilde{f}$ lo"cimo dva primera:
\begin{enumerate}
    \item Optimalni aproksimacijski problemi
    \item interpolacija
\end{enumerate}

\subsubsection{Splo"sen optimalni aproksimacijski problem}
Naj bo $X$ vektorski prostor z normo $\norm{\cdot}$, $S \subseteq X$. Za $f \in X$ i"s"cemo $\tilde{f} \in S$, da velja
\begin{equation}
    \norm{f - \tilde{f}} = \inf_{s \in S} \norm{f - s} = dist(f, S)
\end{equation}
Torej, izmed mo"znih pribli"zkov izberemo najbolj"sega.


Pri tem predmetu si bomo ogledali:
\begin{enumerate}
    \item aproksimacijo po metodi najmanj"sih kvadratov
    
    (za normo izberemo drugo normo - normo iz skalarnega produkta)
    \item enakomerna polinomska aproksimacija ($X = C([a, b])$, $S = P_n$, $\norm{\cdot}_{\inf}$)
\end{enumerate}

Polinomi so zelo uporabni pri aproksimaciji funkcij, saj so gosti v prostoru zveznih funkcij.

\begin{theorem} (Weierstrassov izrek)
    Naj bo $f \in \mathscr{C} ([a, b])$. Potem za vsak $\varepsilon < 0$ obstaja polinom $p$, da je $\norm{f - p}_{\infty, [a, b]} < \varepsilon$. Drugače povedano:
    \begin{equation}
        dist(f, P_n) \to 0 \text{, ko gre } n \to \infty
    \end{equation}
\end{theorem}

\begin{proof}(konstruktivni - ideja)
    Naj bo $[a, b] = [0, 1]$. Za $f \in \mathscr{C} ([0, 1])$ definiramo t.i. $\textbf{Bernsteinov polinom}$:
    \begin{equation}
        \mathscr{B}_n f (x) = \sum_{i = 0}^{n} f (\frac{i}{n}) B_i^n(x)
    \end{equation}
    kjer je $B_i^n(x)$ $\textbf{Bernsteinov bazni polinom}$:
    \begin{equation}
        B_i^n (x) = {n \choose i} x^i (1-x)^{n-i} \text{, } i = 0, 1, \dots, n  
    \end{equation}
    Da se pokazati, da gre $\norm{f - \mathscr{B}_n f}_{\infty, [a, b]} \to 0$, ko gre $n \to \infty$.
\end{proof}

Bernsteinov aproksimacijski polinom nam poda en mo"zen na"cin aproksimacije funkcije $f$ (na $[0, 1]$).

Bernsteinov aproksimacijski operator:

\[\mathscr{B}_n : \mathscr{C} ([a, b]) \to P_n\]
\[f \mapsto \mathscr{B}_n f\]
\begin{equation}
    \mathscr{B}_n f(x) = \sum_{i = 0}^{n} f(a + \frac{i}{n}(b-a)) B_i^n (\frac{x-a}{b-a})
\end{equation}

Po Weierstrassovem izreku imamo zagotovljeno konvergenco v neskon"cni normi, "zal pa je konvergenca zelo po"casna.



% 20. 2. 2023
\subsection{Aproksimacija po metodi najmanjših kvadratov (MNK)}
Sodi pod optimalne aproksimacijske probleme.

Naj bo $X$ normiran vektorski prostor nad $\R$ s skalarnim produktom $\innerproduct{\cdot}{\cdot}$ in naj bo $\norm{\cdot}_2 = \sqrt[]{\innerproduct{\cdot}{\cdot}}$.
$S \subseteq X$ naj bo končno dimenzionalen podprostor v $X$, $S = Lin\{\varphi_1, \varphi_2, \dots, \varphi_n\}$, $dimS = n$. Za izbran $f \in X$ iščemo $f^* \in S$, da bo veljalo
\begin{equation}
    \norm{f - f^*}_2 = \min_{s\in S} \norm{f - s}_2
\end{equation}

$f^*$ naj bo element najbližje aproksimacije (e.n.a.) po MNK za $f \in X$.

\begin{theorem}
    Naj bo $S \subseteq X$ končno dimenzionalen podprostor. Element $f^* \in S$ je element najbližje aproksimacije po MNK za $f \in X$ natanko takrat,
    ko je 
    \[f - f^* \perp S\]
\end{theorem}

\begin{proof}
    ($\Longleftarrow$)
    Predpostavimo, da je $f - f^* \perp S$. Dokazati moramo, da je 
    \[\norm{f - f^*}_2 = \min_{s \in S} \norm{f-s}_2\]
    Izberimo poljuben $s \in S$.
    \begin{align}
        \norm{f - s}_2 &=  \norm{f - f^* + f^* - s}_2\\
                       &= \innerproduct{(f - f^*) + (f^* - s)}{(f - f^*) + (f^* - s)}\\
                       &= \norm{f - f^*}_2^2 + 2 * \innerproduct{f^* - s}{f - f^*} + \norm{f^* - s}_2^2\\
                       &\geq \norm{f - f^*}_2^2
    \end{align}
    $(10)$ velja, saj je (povej zakaj - nimam označeno)
\end{proof}

\begin{proof}
    ($\Longleftarrow$)
    Predpostavimo, da je $f^*$ e.n.a. po MNK.
    Dokazati želimo: $f - f^* \perp S$ (podčrtkano)

    $\forall s \in S \text{ in } \forall \lambda > 0$ velja
    \begin{align}
        \norm{f - f^*}_2 &\leq \norm{f - (f^* - \lambda s)}_2\\
                         &= \innerproduct{f - f^* + \lambda s}{f - f^* + \lambda s}\\
                         &= \norm{f-f^*}_2^2 + 2 * \innerproduct{f - f^*}{\lambda s} + \lambda^2 \norm{s}_2^2
    \end{align}

    \[0 \leq 2 * \innerproduct{f - f^*}{\lambda s} + \lambda^2 \norm{s}_2^2\]
    \[0 \leq \lambda (2\innerproduct{f-f^*}{s} + \lambda \norm{s}_2^2)\]

    Ker lahko $\lambda > 0$ vzamemo tako majhno, da velikost člena $2\innerproduct{f-f^*}{s}$ prevlada nad $\lambda \norm{s}_2^2$, vidimo,
    da mora biti $0 \leq \innerproduct{f-f^*}{s}$. Če sedaj v $S$ izberemo element $-s$, potem pa po istem sklepu velja, da mora biti
    $0 \leq \innerproduct{f - f^*}{-s}$ oziroma $\innerproduct{f - f^*}{s} \leq 0$. Sledi, da mora biti
    \begin{equation}
        \innerproduct{f - f^*}{s} = 0
    \end{equation}
\end{proof}

%Iz izreka sledi konstrukcija .
%
%Izberemo $f \in X$. Naj bodo $\varphi_1, \varphi_2, \dots, \varphi_n$ baza za podprostor $S$:
%\[S = Lin{\varphi_1, \varphi_2, \dots, \varphi_n}\]
%Iščemo $f^* \in S$ e.n.a. po MNK.
%
%\[f^* = \sum_{j = 1}^{n} \alpha_j \varphi_j\]
%
%kjer so $(\alpha_j)_{j = 1}^n$ neznani koeficienti. Iz izreka sledi, da mora biti $f - f^* \perp S$. To bo res $<=>$ ko bo
%\[f - f^* \perp \varphi_i, i \in [n]\]
%\[\innerproduct{f - f^*}{\varphi_i} = 0\]
%\[\innerproduct{f - \sum_{j = 1}^{n}\alpha_j \varphi_j}{\varphi_j} = 0\]
%\[\innerproduct{f}{\varphi_i} - \sum_{j = 1}^{n}\alpha_j \innerproduct{\varphi_j}{\varphi_i} = 0\]
%\[\sum_{j = 1}^{n} \alpha_j \innerproduct{\varphi_j}{\varphi_i} = \innerproduct{f}{\varphi_i}\]
%
%insert enačbo (po vektorjih - cela stran)
%
%\begin{ex}
%    Naj bo $f(x) = \sin (x)$, $\innerproduct{f}{g} = \int_{0}^{\pi} f(x) g(x) dx$. Aproksimiraj $f$ po MNK v podprostoru $\P_1$
%\end{ex}
%Rešitev (prepiši):
%
%\[X = \mathscr{C} ([0, \pi]) (X = \mathscr{L}^2 ([0, \pi]))\]
%\[S = P_1 = Lin\{1, x\}, \varphi_1(x) = 1, \varphi_2 (x) = x\]
%
%\[f^*(x) = \alpha_1 \varphi_1(x) + \alpha_2 \varphi_2(x)\]
%
%G = matrika
%
%Računali smo:
%\[\min_{p \in P_1} \norm{f - p}_2 = \min_{p \in P_1} \sqrt[]{\int_{0}^{\pi} (sinx - p(x)^2) dx}\]
%(skica - minimizacija območja)
%
%\begin{ex}
%    Točke $(1, 2), (2, 3), (3, 5), (4, 8)$ aproksimiraj po MNK s premico.
%
%    $S = P_1 = Lin\{1, x\}$
%    \[\innerproduct{f}{g} = \sum_{i = 1}^{4} f(x_i), g(x_i)\]
%    x = [1, 2, 3, 4]^T (piši kot vektor)
%    $f$, ki jo aproksimiramo, je znana le v točkah x (piši kot vektor).
%
%    Gramova matrika:
%    \[\innerproduct{\varphi_1}{\varphi_1} = \sum_{i = 1}^{4}1\cdot1 = 4\]
%    \[\innerproduct{\varphi_1}{\varphi_2} = \sum_{i = 1}^{4}1\cdotx_i = 10\]
%    \[\innerproduct{\varphi_2}{\varphi_2} = \sum_{i = 1}^{4}x_i^2 = 30\]
%    (Zapiši gramovo matriko)
%
%    \[\innerproduct{f}{\varphi_1} = \sum_{i = 1}^{4} y_i \cdot 1 = 18, \innerproduct{f}{\varphi_2} = \sum_{i = 1}^{4} y_i x_i = 55\]
%
%    (sistem)
%    Minimizirali smo
%    \begin{equation}
%        \min_{p \in P_1} \norm{f - p}_2 =\sqrt[root]{\sum_{i = 1}^{4} (x_i \cdot -p(x_i))^2}
%    \end{equation}
%    (skica)
%\end{ex}
%
%
%Povezava te teorije s predoločenimi sistemi enačb. (subsection al neki tazga)
%
%\begin{equation}
%    Ax = b, A\in \R^{mxn}, A = [a_q a_2 \dots a_n], a_j \dots j-ti stolpec od matrike A, b \in R^m\\
%    \min_{x \in \R^n \norm{Ax - b}_2}
%\end{equation}
%
%Aproksimiramo vektor $b \in \R^m (X = \R^m)$
%\[S = Lin\{a_1, a_2, \dots, a_n\} = ImA\]
%\[b^* = \sum_{j = 1}^{n}x_j a_j = Ax\]
%\[\min_{z \in ImA} \norm{b-z} = min_{x \in \R^m} \norm{b-Ax}_2\]
%\[\innerproduct{x}{y} = \sum_{i = 1}^{m}x_i y_i = x^T y\]
%
%G = neki
%desna stran (neki)
%
%\begin{ex}
%    $X = \mathscr{C} ([0, 1])$
%    \[S = P_{n-1} = Lin\{1, x, x^2, \dots, x^{n-1}\}\]
%    \[\innerproduct{f}{g} = \int_{0}^{1} f(x) g(x) dx\]
%    \[\innerproduct{\varphi_i}{\varphi_j} = \int_{0}^{1} x^{i-1} x^{j-1} dx = \int_{0}^{1}x^{i+j-2} dx = \frac{1}{i+j-1}\]
%
%    \[G ? (\frac{1}{i+j-1})_{i, j = 1}^n\]
%    Hilbertova matrika
%\end{ex}
%


\end{document}
